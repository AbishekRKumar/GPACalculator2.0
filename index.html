<!DOCTYPE html>
<html lang="en">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5HL4F5ZJGK"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-5HL4F5ZJGK');
</script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OUSL GPA Calculator</title>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
  <!-- XLSX Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
  <!-- Canvas Confetti Library -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
  <style>
    :root {
      --primary: #4361EE;
      --secondary: #3A0CA3;
      --background: #FFFFFF;
      --text: #1a1a1a;
      --accent: #E6E6FA;
    }
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #4361EE 0%, #3A0CA3 100%);
      color: var(--text);
      line-height: 1.6;
      min-height: 100vh;
      padding: 2rem;
      transition: background 0.3s, color 0.3s;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      padding: 2rem;
      backdrop-filter: blur(10px);
      transition: background 0.3s;
    }
    h1 {
      color: var(--primary);
      margin-bottom: 2rem;
      text-align: center;
      font-size: 2.5rem;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
    }
    /* Top Bar for Language & Dark Mode */
    .top-bar {
      display: flex;
      justify-content: flex-end;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    .top-bar select,
    .top-bar button {
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
      border-radius: 8px;
      border: 1px solid var(--primary);
      background: var(--accent);
      cursor: pointer;
    }
    /* In light mode, dark/light toggle gets a darker background */
    body:not(.dark-mode) #darkModeToggle {
      background: var(--secondary);
    }
    .course {
      display: grid;
      grid-template-columns: 2fr 1fr 1fr auto;
      gap: 1rem;
      margin-bottom: 1rem;
      align-items: center;
      background: var(--accent);
      padding: 1rem;
      border-radius: 12px;
      animation: slideIn 0.3s ease;
    }
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .course input,
    .course select {
      padding: 0.8rem;
      border: 2px solid var(--primary);
      border-radius: 12px;
      font-size: 0.9rem;
      transition: all 0.3s ease;
      background: white;
      color: var(--text);
    }
    input:focus, select:focus {
      outline: none;
      border-color: var(--secondary);
      box-shadow: 0 0 0 4px rgba(255, 107, 53, 0.2);
    }
    .deleteCourseButton {
      background: none;
      border: none;
      color: var(--primary);
      cursor: pointer;
      font-size: 1.2rem;
      transition: color 0.3s ease;
    }
    .deleteCourseButton:hover {
      color: var(--secondary);
    }
    button {
      padding: 1rem;
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.8rem;
      justify-content: center;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-size: 1rem;
      border-radius: 12px;
      transition: transform 0.2s, opacity 0.2s;
    }
    button:hover {
      opacity: 0.9;
      transform: translateY(-2px);
    }
    #result {
      margin-top: 2rem;
      padding: 2rem;
      background: var(--accent);
      border-radius: 16px;
      text-align: center;
      display: none;
    }
    .gpa-display {
      font-size: 3rem;
      color: var(--primary);
      font-weight: 800;
      margin: 1rem 0;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
    }
    /* Motivational message style */
    #motivationalMessage {
      font-style: italic;
      margin-top: 1rem;
    }
    .actions {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-top: 2rem;
      flex-wrap: wrap;
    }
    .developer-info {
      margin-top: 3rem;
      padding: 1.5rem;
      background: rgba(255, 107, 53, 0.1);
      border-radius: 12px;
      text-align: center;
      border-top: 3px solid var(--primary);
    }
    .developer-info p, .disclaimer p {
      margin: 0.5rem 0;
      color: inherit;
      font-size: 0.9rem;
    }
    .developer-info a {
      color: var(--primary);
      text-decoration: none;
      font-weight: 500;
    }
    .developer-info a:hover {
      text-decoration: underline;
    }
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      background: var(--accent);
      padding: 0.5rem 1rem;
      border-radius: 25px;
      margin: 0.5rem 0;
    }
    /* Dark Mode Adjustments */
    .dark-mode {
      background: #121212;
      color: #f5f5f5;
    }
    .dark-mode .container {
      background: #1E1E1E;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.8);
    }
    .dark-mode h1,
    .dark-mode p,
    .dark-mode .course input,
    .dark-mode .course select,
    .dark-mode .top-bar select,
    .dark-mode .top-bar button,
    .dark-mode .badge {
      color: #f5f5f5;
    }
    .dark-mode .course input,
    .dark-mode .course select {
      background: #2D2D2D;
      border-color: #444;
    }
    .dark-mode .top-bar select,
    .dark-mode .top-bar button {
      background: #2D2D2D;
      border-color: #444;
    }
    /* Override academic summary background in dark mode */
    .dark-mode #result {
      background: #2D2D2D;
      color: #f5f5f5;
    }
    /* In dark mode, change Developer Information background to an even darker colour */
    .dark-mode .developer-info {
      background: #0A0A0A;
      color: #f5f5f5;
      border-top: 3px solid #4361EE;
    }
    /* Floating Action Button */
    .fab {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      color: white;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      cursor: pointer;
      z-index: 1000;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .fab:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
    }
    .fab i {
      font-size: 1.5rem;
    }
    
    /* Upload Section Styles */
    .upload-section {
      margin-top: 2rem;
      padding: 1.5rem;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      text-align: center;
    }
    .dark-mode .upload-section {
      background: rgba(30, 30, 30, 0.3);
    }
    .upload-area {
      border: 2px dashed var(--primary);
      border-radius: 12px;
      padding: 2rem;
      margin: 1rem 0;
      cursor: pointer;
      transition: all 0.3s;
    }
    .upload-area:hover {
      background: rgba(67, 97, 238, 0.1);
    }
    .upload-area i {
      font-size: 3rem;
      margin-bottom: 1rem;
      color: var(--primary);
    }
    #fileInput {
      display: none;
    }
    #parseResults {
      margin-top: 1rem;
      text-align: left;
      max-height: 300px;
      overflow-y: auto;
    }
    .parsed-course {
      padding: 0.5rem;
      border-bottom: 1px solid #eee;
    }
    .dark-mode .parsed-course {
      border-bottom: 1px solid #444;
    }
    .process-button {
      padding: 0.8rem 1.5rem;
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 1rem;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }

    /* ---------------- Mobile Friendly Adjustments ---------------- */
    @media (max-width: 600px) {
      body {
        padding: 1rem;
      }
      .container {
        padding: 1rem;
        /* Increase top margin to ensure the fixed top bar does not overlap the title */
        margin-top: 150px;
      }
      .top-bar {
        position: fixed;
        top: 10px;
        right: 10px;
        flex-direction: row;
        gap: 0.5rem;
        margin: 0;
        padding: 0.5rem;
        z-index: 1000;
      }
      .top-bar select,
      .top-bar button {
        padding: 0.3rem 0.5rem;
        font-size: 0.8rem;
        width: auto;
      }
      .course {
        grid-template-columns: 1fr;
      }
      .course input,
      .course select,
      .course button {
        width: 100%;
      }
      .actions {
        flex-direction: column;
        gap: 0.5rem;
      }
      .upload-area {
        padding: 1rem;
      }
    }
  </style>
</head>
<body>
 
  <!-- Updated datalist with all courses -->
  <datalist id="courseList">
    <!-- Level 3 Courses -->
    <option value="BYU3301" data-credits="3">Organization of Cells and Plant Biochemistry</option>
    <option value="BYU3500" data-credits="5">Diversity of Plants</option>
    <option value="CYU3300" data-credits="3">Basic Principles of Chemistry I</option>
    <option value="CYU3201" data-credits="2">Basic Principles of Chemistry II</option>
    <option value="CYU3302" data-credits="3">Basic Practical Chemistry</option>
    <option value="PHU3300" data-credits="3">General and Thermal Physics</option>
    <option value="PHU3301" data-credits="3">Basic Electromagnetism</option>
    <option value="PHU3202" data-credits="2">Waves in Physics</option>
    <option value="ZYU3500" data-credits="5">Animal Life and Diversity</option>
    <option value="ZYU3301" data-credits="3">Biogeography</option>
    <option value="CSU3200" data-credits="2">Introduction to Computer Programming</option>
    <option value="CSU3301" data-credits="3">Database Design and Implementation</option>
    <option value="CSU3302" data-credits="3">Data Structures & Algorithms</option>
    <option value="ADU3300" data-credits="3">Vector Algebra</option>
    <option value="ADU3201" data-credits="2">Basic Statistics</option>
    <option value="ADU3302" data-credits="3">Differential Equations</option>
    <option value="PEU3300" data-credits="3">Mathematical Logic and Mathematical Proofs</option>
    <option value="PEU3301" data-credits="3">Foundations of Mathematics</option>
    <option value="PEU3202" data-credits="2">Vector Spaces</option>
    
    <!-- Open Elective Courses Level 3 -->
    <option value="ADU3218" data-credits="2">Basic Statistics</option>
    <option value="DSU3298" data-credits="2">Introduction to Sri Lankan Society</option>
    <option value="FNU3200" data-credits="2">Ethics in Science & Technology</option>
    <option value="FNU3201" data-credits="2">Communication Skills</option>
    <option value="LLU3261" data-credits="2">Understanding Law</option>
    <option value="OSU3208" data-credits="2">Managing Your Work and People</option>
    
    <!-- Continuing Education Courses -->
    <option value="ADE3200" data-credits="2">Applied Calculus I</option>
    <option value="CSE3214" data-credits="2">Information & Communication Technology Skills</option>
    <option value="CYE3200" data-credits="2">Mathematics for Chemistry and Biology</option>
    <option value="FDE3021" data-credits="0">Empowering for Independent Learning (EfIL)</option>
    <option value="LTE3407" data-credits="4">English for General Academic Purposes (EGAP)</option>
    
    <!-- Level 4 Courses -->
    <option value="BYU4300" data-credits="3">Plant Physiology</option>
    <option value="BYU4301" data-credits="3">Genetics and Evolution</option>
    <option value="BYU4302" data-credits="3">Systematics of Higher Plants and Animals</option>
    <option value="BYU4303" data-credits="3">Principles of Microbiology</option>
    <option value="CYU4300" data-credits="3">Inorganic Chemistry</option>
    <option value="CYU4301" data-credits="3">Concepts in Chemistry</option>
    <option value="CYU4302" data-credits="3">Practical Chemistry II</option>
    <option value="CYU4303" data-credits="3">Organic Chemistry I</option>
    <option value="PHU4300" data-credits="3">Modern Physics</option>
    <option value="PHU4301" data-credits="3">Electronics</option>
    <option value="PHU4302" data-credits="3">Optics</option>
    <option value="PHU4303" data-credits="3">Mathematical Methods for Physics</option>
    <option value="ZYU4300" data-credits="3">Animal Form and Function</option>
    <option value="ZYU4301" data-credits="3">Ecology</option>
    <option value="ZYU4302" data-credits="3">Animal Development</option>
    <option value="ZYU4303" data-credits="3">Animal Behaviour</option>
    <option value="CSU4300" data-credits="3">Operating Systems</option>
    <option value="CSU4301" data-credits="3">Object Oriented Programming</option>
    <option value="CSU4302" data-credits="3">System Analysis & Software Engineering</option>
    <option value="CSU4303" data-credits="3">Computer Networks</option>
    <option value="ADU4300" data-credits="3">Statistical Distribution Theory</option>
    <option value="ADU4301" data-credits="3">Newtonian Mechanics I</option>
    <option value="ADU4302" data-credits="3">Vector Calculus</option>
    <option value="ADU4303" data-credits="3">Applied Linear Algebra and Differential Equations</option>
    <option value="PEU4300" data-credits="3">Real Analysis I</option>
    <option value="PEU4301" data-credits="3">Real Analysis II</option>
    <option value="PEU4302" data-credits="3">Linear Algebra</option>
    <option value="PEU4303" data-credits="3">Group Theory I</option>
    
    <!-- Level 5 Courses -->
    <option value="BYU5300" data-credits="3">Environmental and Applied Microbiology</option>
    <option value="BYU5301" data-credits="3">Plant Pathology</option>
    <option value="BYU5302" data-credits="3">Plant Growth and Development</option>
    <option value="BYU5303" data-credits="3">Plants and Man</option>
    <option value="BYU5304" data-credits="3">Soils and Plant Growth</option>
    <option value="BYU5305" data-credits="3">Literature Review in Botany (Limited Registration)</option>
    <option value="BYU5306" data-credits="3">Plant Breeding</option>
    <option value="BYU5307" data-credits="3">Forest Management& its Conservation</option>
    <option value="BYU5308" data-credits="3">Postharvest Technology of Fresh Produce</option>
    <option value="BYU5610" data-credits="6">Research Project in Botany (Limited Registration)</option>
    <option value="CYU5300" data-credits="3">Organometallic Chemistry</option>
    <option value="CYU5301" data-credits="3">Concepts in Spectroscopy</option>
    <option value="CYU5302" data-credits="3">Analytical Chemistry</option>
    <option value="CYU5303" data-credits="3">Organic Chemistry II</option>
    <option value="CYU5304" data-credits="3">Chemistry of Biomolecules</option>
    <option value="CYU5305" data-credits="3">Natural Product Chemistry</option>
    <option value="CYU5306" data-credits="3">Biochemistry</option>
    <option value="CYU5307" data-credits="3">Chemical aspects of Food Industry</option>
    <option value="CYU5308" data-credits="3">Instrumental Methods of Chemical Analysis</option>
    <option value="CYU5310" data-credits="3">Literature Project in Chemistry</option>
    <option value="CYU5611" data-credits="6">Research Project in Chemistry</option>
    <option value="CYU5312" data-credits="3">Industrial Chemistry I</option>
    <option value="CYU5614" data-credits="6">Physical Chemistry I</option>
    <option value="CYU5615" data-credits="6">Advanced Organic Chemistry</option>
    <option value="PHU5300" data-credits="3">Nuclear and Particle Physics</option>
    <option value="PHU5301" data-credits="3">Practical Physics</option>
    <option value="PHU5302" data-credits="3">Atmospheric Physics</option>
    <option value="PHU5303" data-credits="3">Data Acquisition and Signal Processing</option>
    <option value="PHU5304" data-credits="3">Biophysics</option>
    <option value="PHU5305" data-credits="3">Essentials of Geology</option>
    <option value="PHU5306" data-credits="3">Applied Geology</option>
    <option value="PHU5307" data-credits="3">Medical Physics</option>
    <option value="PHU5308" data-credits="3">Fundamentals of Geophysics</option>
    <option value="PHU5309" data-credits="3">Literature Survey Project in Physics</option>
    <option value="PHU5610" data-credits="6">Research Project in Physics</option>
    <option value="PHU5311" data-credits="3">Astronomy</option>
    <option value="PHU5312" data-credits="3">Solid State Physics</option>
    <option value="PHU5313OP" data-credits="3">Advanced Electromagnetism</option>
    <option value="PHU5314OP" data-credits="3">Thermodynamics</option>
    <option value="PHU5315OP" data-credits="3">Renewable Energy Sources</option>
    <option value="PHU5318" data-credits="3">Electronics for Biology Students</option>
    <option value="ZYU5300" data-credits="3">Aquatic Biology</option>
    <option value="ZYU5301" data-credits="3">Fish Biology and Fishery Management</option>
    <option value="ZYU5302" data-credits="3">Conservation & Management of Biodiversity</option>
    <option value="ZYU5303" data-credits="3">Environmental Toxicology</option>
    <option value="ZYU5304" data-credits="3">Parasitology</option>
    <option value="ZYU5305" data-credits="3">Human Biology</option>
    <option value="ZYU5306" data-credits="3">Entomology</option>
    <option value="ZYU5307" data-credits="3">Mammalian Biology</option>
    <option value="ZYU5608" data-credits="6">Zoology Project</option>
    <option value="ZYU5309" data-credits="3">Palaeobiology</option>
    <option value="ZYU5310" data-credits="3">Concepts and Application of Evolution Biology</option>
    <option value="ZYU5311" data-credits="3">Literature Review in Zoology</option>
    <option value="ZYU5312" data-credits="3">Zoology Essay</option>
    <option value="ZYU5313" data-credits="3">Research Methodology</option>
    <option value="ZYU5314" data-credits="3">Fundamentals of Ornithology</option>
    <option value="ZYU5315" data-credits="3">Fundamentals of Molecular Biology</option>
    <option value="CSU5300" data-credits="3">IT Project Management</option>
    <option value="CSU5301" data-credits="3">Software Quality Assurance</option>
    <option value="CSU5302" data-credits="3">Web Technologies</option>
    <option value="CSU5303" data-credits="3">Management Information Systems</option>
    <option value="CSU5304" data-credits="3">Mathematics for Computing</option>
    <option value="CSU5305" data-credits="3">Theory of Computing</option>
    <option value="CSU5306" data-credits="3">Digital Electronics</option>
    <option value="CSU5312" data-credits="3">Wireless and Cellular Networks</option>
    <option value="CSU5308" data-credits="3">Artificial Intelligence</option>
    <option value="CSU5317" data-credits="3">Artificial Intelligence</option>
    <option value="CSU5309" data-credits="3">Information Security & Cryptography</option>
    <option value="CSU5310" data-credits="3">Computer Architecture</option>
    <option value="CSU5311" data-credits="3">Computer Graphics</option>
    <option value="CSU5320" data-credits="3">Project in Computer Science</option>
    <option value="ADU5300" data-credits="3">Linear Programming</option>
    <option value="ADU5301" data-credits="3">Regression Analysis I</option>
    <option value="ADU5302" data-credits="3">Mathematical Methods</option>
    <option value="ADU5303" data-credits="3">Newtonian Mechanics II</option>
    <option value="ADU5304" data-credits="3">Operational Research</option>
    <option value="ADU5305" data-credits="3">Statistical Inference</option>
    <option value="ADU5306" data-credits="3">Fluid Mechanics</option>
    <option value="ADU5307" data-credits="3">Numerical Methods</option>
    <option value="ADU5308" data-credits="3">Graph Theory</option>
    <option value="ADU5309" data-credits="3">Design and Analysis of Experiments</option>
    <option value="ADU5310" data-credits="3">Time Series Analysis</option>
    <option value="ADU5312" data-credits="3">Data Mining Techniques</option>
    <option value="ADU5313" data-credits="3">Generalized Linear Models</option>
    <option value="ADU5314" data-credits="3">Sampling Techniques</option>
    <option value="ADU5615" data-credits="6">Project in Mathematics</option>
    <option value="PEU5300" data-credits="3">Riemann Integration</option>
    <option value="PEU5301" data-credits="3">Ring Theory</option>
    <option value="PEU5302" data-credits="3">Combinatorics</option>
    <option value="PEU5303" data-credits="3">Number Theory</option>
    <option value="PEU5304" data-credits="3">Introduction to Complex Analysis</option>
    <option value="PEU5305" data-credits="3">Complex Analysis I</option>
    <option value="PEU5306" data-credits="3">Introduction to dynamical systems</option>
    <option value="PEU5307" data-credits="3">Cryptography</option>
    
    <!-- Open Elective Courses Level 5 -->
    <option value="ADU5318" data-credits="3">Bio Statistics</option>
    <option value="ADU5319" data-credits="3">Design and Analysis of Experiments</option>
    <option value="ADU5320" data-credits="3">Introduction to MATLAB Software</option>
    <option value="BYU5318" data-credits="3">Environmental Studies</option>
    <option value="FNU5300" data-credits="3">GIS and Remote Sensing in Natural Resource Management</option>
    <option value="FNU5301" data-credits="3">Environmental Degradation Management</option>
    <option value="FNU5302" data-credits="3">Fundamentals of Environmental Impact Assessment</option>
    <option value="ADU5321" data-credits="3">Applied Calculus II</option>
    
    <!-- Level 6 Courses -->
    <option value="BYU6300" data-credits="3">Plant Molecular Biology</option>
    <option value="BYU6301" data-credits="3">Bioinformatics</option>
    <option value="BYU6302" data-credits="3">Biotechnology</option>
    <option value="BYU6303" data-credits="3">Experimental Design and Biological data Analysis</option>
    <option value="BYU6304" data-credits="3">Integrated Crop Protection</option>
    <option value="BYU6305" data-credits="3">Industrial Microbiology</option>
    <option value="BYU6306" data-credits="3">Molecular Systematics</option>
    <option value="BYU6307" data-credits="3">Advanced Plant Physiology and Biochemistry</option>
    <option value="BYU6308" data-credits="3">Advanced Ecology</option>
    <option value="BYU6309" data-credits="3">Soil Biology</option>
    <option value="BYU6310" data-credits="3">Advanced Plant Pathology</option>
    <option value="BYU6911" data-credits="9">Research Project in Botany (Special Degree)</option>
    <option value="BYU6313" data-credits="3">Special Topics in Botany</option>
    <option value="CYU6600" data-credits="6">Advanced Concepts in Chemistry</option>
    <option value="CYU6301" data-credits="3">Selected topics in Inorganic Chemistry</option>
    <option value="CYU6304" data-credits="3">Inorganic Spectroscopy & Structural Chemistry</option>
    <option value="CYU6305" data-credits="3">Concepts in Industrial Chemistry</option>
    <option value="CYU6606" data-credits="6">Advanced Experimental Chemistry</option>
    <option value="CYU6307" data-credits="3">Industrial Training and Literature Seminar</option>
    <option value="CYU6608" data-credits="9">Research Project in Chemistry</option>
    <option value="PHU6300" data-credits="3">Advanced Practical in Physics</option>
    <option value="PHU6301" data-credits="3">Advanced Solid-State Physics</option>
    <option value="PHU6302" data-credits="3">Advanced Quantum Mechanics</option>
    <option value="PHU6603" data-credits="6">Advanced Research Project in Physics</option>
    <option value="PHU6304" data-credits="3">Advanced Electronics</option>
    <option value="PHU6305" data-credits="3">Nanophysics and its Applications</option>
    <option value="PHU6306" data-credits="3">Statistical Physics</option>
    <option value="PHU6307" data-credits="3">Modern Optics</option>
    <option value="PHU6308" data-credits="3">Classical Mechanics</option>
    <option value="ZYU6300" data-credits="3">Management of Insect Pests and Vectors</option>
    <option value="ZYU6301" data-credits="3">Aquaculture</option>
    <option value="ZYU6302" data-credits="3">Immunology</option>
    <option value="ZYU6605" data-credits="6">Advanced Laboratory Techniques in Zoology</option>
    <option value="ZYU6306" data-credits="3">Advanced Ornithology</option>
    <option value="ZYU6908" data-credits="9">Research Project in Zoology</option>
    <option value="ZYU6309" data-credits="3">Oceanography and Ocean Resources</option>
    <option value="ZYU6310" data-credits="3">Wildlife Management and Conservation</option>
    <option value="ZYU6311" data-credits="3">Special Topics in Zoology</option>
    <option value="ZYU6312" data-credits="3">Wildlife DNA forensics</option>
    <option value="ZYU6313" data-credits="3">Advanced Techniques in Molecular Biology</option>
    <option value="ADU6300" data-credits="3">Stochastic Processes</option>
    <option value="ADU6301" data-credits="3">Regression Analysis II</option>
    <option value="ADU6302" data-credits="3">Statistical Quality Control</option>
    <option value="ADU6303" data-credits="3">Actuarial Mathematics</option>
    <option value="ADU6304" data-credits="3">Computational Mathematics</option>
    <option value="ADU6305" data-credits="3">Optimization Theory</option>
    <option value="ADU6306" data-credits="3">Mathematical Modelling</option>
    <option value="PEU6300" data-credits="3">Group Theory II</option>
    <option value="PEU6601" data-credits="6">Point Set Topology</option>
    <option value="PEU6602" data-credits="6">Measure Theory</option>
    <option value="PEU6303" data-credits="3">Complex Analysis II</option>
    <option value="PEU6304" data-credits="3">Functional Analysis</option>
    <option value="PEU6305" data-credits="3">Introduction to Galois Theory</option>
    <option value="PEU6306" data-credits="3">Advanced Topics in Real Analysis</option>
    <option value="PEU6611" data-credits="6">Research project in Mathematics</option>
  </datalist>

  <!-- Fixed Top Bar (remains outside the container) -->
  <div class="top-bar">
    <select id="languageSelect">
      <option value="en">English</option>
      <option value="ta">தமிழ்</option>
      <option value="si">සිංහල</option>
    </select>
    <button id="darkModeToggle">
      <i class="fas fa-moon"></i> <span id="darkModeText">Dark Mode</span>
    </button>
  </div>

  <div class="container">
    <h1 id="pageTitle"><i class="fas fa-calculator"></i> OUSL GPA Calculator</h1>

    <form id="gpaForm">
      <div id="coursesContainer">
        <!-- Courses will be added dynamically -->
      </div>
      <div class="actions">
        <button type="button" id="addCourseButton">
          <i class="fas fa-plus-circle"></i> <span data-translate="addCourse">Add Course</span>
        </button>
        <button type="submit" id="calculateButton" disabled>
          <i class="fas fa-calculator"></i> <span data-translate="calculateGPA">Calculate GPA</span>
        </button>
      </div>
    </form>

    <div id="result">
      <h2 data-translate="academicSummary">Your Academic Summary</h2>
      <div class="gpa-display"><span id="gpaValue">0.00</span></div>
      <p id="gpaClass" class="gpa-class"></p>
      <!-- Motivational message -->
      <p id="motivationalMessage"></p>
      <div class="actions">
        <button id="shareButton">
          <i class="fas fa-share-alt"></i> <span data-translate="shareResults">Share Results</span>
        </button>
      </div>
    </div>

    <!-- Marksheet Upload Section -->
    <div class="upload-section">
      <h2 data-translate="uploadHeader">Upload Official Marksheet</h2>
      <p data-translate="uploadDescription">Drop your official OUSL marksheet from MyOUSL here or click to browse</p>
      
      <div class="upload-area" id="dropArea">
        <i class="fas fa-file-upload"></i>
        <p data-translate="uploadAction">Select or drop .xls file</p>
        <input type="file" id="fileInput" accept=".xls,.xlsx">
      </div>
      
      <div id="parseResults"></div>
    </div>

    <div class="developer-info">
      <div class="badge">
        <i class="fas fa-user-graduate" style="color: var #0000FF;"></i>
        <span data-translate="devInfo">Developer Information</span>
      </div>
      
      <p><div class="badge-base LI-profile-badge" data-locale="en_US" data-size="medium" data-theme="light" data-type="VERTICAL" data-vanity="abishek-rathnakumar-lk" data-version="v1"><a class="badge-base__link LI-simple-link" href="https://lk.linkedin.com/in/abishek-rathnakumar-lk?trk=profile-badge">Abishek Rathnakumar</a></div>   BSc (Natural Sciences) - Undergraduate</p>
      <p>The Open University of Sri Lanka</p>
      <p>
        <i class="fas fa-envelope"></i> <span data-translate="contact">Contact:</span>
        <a href="mailto:abi.kumar6324@gmail.com">abi.kumar6324@gmail.com</a>
      </p>
      <p style="margin-top: 1rem; font-size: 0.8rem;">
        <i class="fas fa-code"></i> <span data-translate="crafted">Crafted with care for OUSL students</span>
      </p>
    </div>

    <div class="disclaimer">
      <p>
        <i class="fas fa-info-circle"></i>
        <strong>Note:</strong> When you click the <em>Share Results</em> button, an Excel file containing your course details and calculated GPA will be downloaded. Later, you can use the <em>Load Existing Data</em> option to upload this file which allows you to retrieve your previous records, add new courses, and recalculate your updated GPA. This tool is independent and not affiliated with The Open University of Sri Lanka. Please verify results with official university sources.
      </p>
    </div>

    <!-- Load Existing Data Button -->
    <div class="actions" style="margin-top: 1rem;">
      <button type="button" id="uploadExcelButton">
        <i class="fas fa-file-upload"></i> <span data-translate="loadData">Load Existing Data</span>
      </button>
      <input type="file" id="uploadExcelInput" accept=".xlsx, .xls" style="display: none;">
    </div>
  </div>

  <script>
    // --------- Multi-language Support ---------
    const translations = {
      en: {
        addCourse: "Add Course",
        calculateGPA: "Calculate GPA",
        academicSummary: "Your Academic Summary",
        shareResults: "Share Results",
        devInfo: "Developer Information",
        contact: "Contact:",
        crafted: "Crafted with care for OUSL students",
        disclaimer: "Note: When you click the Share Results button, an Excel file containing your course details and calculated GPA will be downloaded. Later, you can use the Load Existing Data option to upload this file allows you to retrieve your previous records, add new courses, and recalculate your updated GPA. This tool is independent and not affiliated with The Open University of Sri Lanka. Please verify results with official university sources.",
        loadData: "Load Existing Data",
        darkMode: "Dark Mode",
        lightMode: "Light Mode",
        uploadHeader: "Upload MYOUSL Marksheet",
        uploadDescription: "Drop your official OUSL marksheet file from MyOUSL or click to browse",
        uploadAction: "Select or drop .xls file",
        coursesFound: "Courses found:",
        addToCalculator: "Add to Calculator",
        credits: "Credits",
        grade: "Grade",
        coursesAdded: "courses added to calculator"
      },
      ta: {
        addCourse: "பாடம் சேர்க்கவும்",
        calculateGPA: "GPA கணக்கு",
        academicSummary: "உங்கள் கல்வி சுருக்கம்",
        shareResults: "முடிவுகளை பகிரவும்",
        devInfo: "வளர்ச்சி தகவல்",
        contact: "தொடர்பு:",
        crafted: "OUSL மாணவர்களுக்காக அக்கறையுடன் உருவாக்கப்பட்டது",
        disclaimer: "குறிப்பு: 'முடிவுகளை பகிரவும்' பொத்தானை அழுத்தும் போது, உங்கள் பாடப் தகவல்களும் கணிக்கப்பட்ட GPA-வும் கொண்ட Excel கோப்பு பதிவிறக்கம் செய்யப்படும். பின்னர், 'கூட இருப்புத் தரவை ஏற்று' என்பதன் மூலம் இந்த கோப்பை மீண்டும் ஏற்று, உங்கள் முந்தைய பதிவுகளை பெறலாம்; புதிய பாடங்களைச் சேர்த்து, இப்போது புதுப்பிக்கப்பட்ட GPA-ஐ மீண்டும் கணக்கிடலாம். இந்த கருவி OUSL-க்கு சார்ந்தது அல்ல. அதிகாரப்பூர்வ பல்கலைக்கழக தகவல்களுடன் முடிவுகளை சரிபார்க்கவும்.",
        loadData: "கூட இருப்புத் தரவை ஏற்று",
        darkMode: "இருண்ட முறை",
        lightMode: "வெளிச்சம் முறை",
        uploadHeader: "அதிகாரப்பூர்வ மதிப்பெண் பட்டியலை பதிவேற்று",
        uploadDescription: "உங்கள் அதிகாரப்பூர்வ OUSL மதிப்பெண் பட்டியல் கோப்பை இங்கே விடவும் அல்லது உலாவ கிளிக் செய்யவும்",
        uploadAction: ".xls கோப்பைத் தேர்ந்தெடு அல்லது இழு",
        coursesFound: "பாடங்கள் கண்டறியப்பட்டது:",
        addToCalculator: "கால்குலேட்டரில் சேர்",
        credits: "கடன் புள்ளிகள்",
        grade: "தரம்",
        coursesAdded: "பாடங்கள் கால்குலேட்டரில் சேர்க்கப்பட்டது"
      },
      si: {
        addCourse: "පාඨමාලා එකතු කරන්න",
        calculateGPA: "GPA ගණනය කරන්න",
        academicSummary: "ඔබගේ අධ්‍යයන සාරාංශය",
        shareResults: "ප්‍රතිඵල බෙදාගන්න",
        devInfo: "සංවර්ධක තොරතුරු",
        contact: "සම්බන්ධ වන්න:",
        crafted: "OUSL ශිෂ්‍යයින් සඳහා ආදරයෙන් නිර්මාණය කරන ලදි",
        disclaimer: "සටහන්: 'ප්‍රතිඵල බෙදාගන්න' බොත්තම ඔබන විට, ඔබගේ පාඨමාලා විස්තර සහ ගණනය කරන ලද GPA අඩංගු Excel ගොනුවක් බාගත වේ. පසුව, 'දැනට පවතින දත්ත උඩුගත කරන්න' විකල්පය භාවිතා කර මෙම ගොනුව උඩුගත කර ඔබගේ පසුගිය තොරතුරු ප්‍රාප්ත කර, නව පාඨමාලා එක් කර, යාවත්කාලීන GPA ගණනය කළ හැකිය. මෙම මෙවලම OUSL-ට අයත් නොවන අතර, කරුණාකර නිල විශ්වවිද්‍යාල සම්පත් සමඟ ප්‍රතිඵල සනාථ කරන්න.",
        loadData: "දැනට පවතින දත්ත උඩුගත කරන්න",
        darkMode: "අඳුරු මාදිලිය",
        lightMode: "පැහැදිලි මාදිලිය",
        uploadHeader: "නිල ලකුණු පත්‍රය උඩුගත කරන්න",
        uploadDescription: "ඔබගේ නිල OUSL ලකුණු පත්‍ර ගොනුව මෙහි අතහැර දමන්න හෝ පිරික්සීමට ක්ලික් කරන්න",
        uploadAction: ".xls ගොනුව තෝරන්න හෝ ඇද දමන්න",
        coursesFound: "පාඨමාලා හමුවිය:",
        addToCalculator: "ගණකයට එක් කරන්න",
        credits: "කෙටි",
        grade: "ශ්‍රේණිය",
        coursesAdded: "පාඨමාලා ගණක යන්ත්‍රයට එකතු කරන ලදි"
      }
    };

    function updateLanguageTexts(lang) {
      document.querySelectorAll('[data-translate]').forEach(el => {
        const key = el.getAttribute('data-translate');
        el.textContent = translations[lang][key];
      });
      // Update page title (if needed)
      document.getElementById('pageTitle').innerHTML = `<i class="fas fa-calculator"></i> OUSL GPA Calculator`;
      // Update dark mode button text based on current mode
      const darkModeToggleText = document.getElementById('darkModeText');
      if (document.body.classList.contains('dark-mode')) {
        darkModeToggleText.textContent = translations[lang].lightMode;
      } else {
        darkModeToggleText.textContent = translations[lang].darkMode;
      }
      // Update disclaimer text
      document.querySelector('.disclaimer p').textContent = translations[lang].disclaimer;
    }

    // Default language is English
    let currentLang = 'en';
    updateLanguageTexts(currentLang);
    document.getElementById('languageSelect').addEventListener('change', (e) => {
      currentLang = e.target.value;
      updateLanguageTexts(currentLang);
    });

    // --------- Dark Mode Toggle ---------
    document.getElementById('darkModeToggle').addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
      updateLanguageTexts(currentLang);
    });

    // --------- Course Functions ---------
    const coursesContainer = document.getElementById('coursesContainer');
    coursesContainer.innerHTML = '';

    function saveCourses() {
      localStorage.setItem('courses', coursesContainer.innerHTML);
      document.getElementById('calculateButton').disabled = coursesContainer.children.length === 0;
    }

    function createCourseElement() {
      const course = document.createElement('div');
      course.className = 'course';
      course.innerHTML = `
        <input type="text" placeholder="Course Name" required list="courseList">
        <input type="number" placeholder="Credits" min="1" step="0.5" required>
        <select required>
          <option value="4">A+</option>
          <option value="4">A</option>
          <option value="3.7">A-</option>
          <option value="3.3">B+</option>
          <option value="3">B</option>
          <option value="2.7">B-</option>
          <option value="2.3">C+</option>
          <option value="2">C</option>
          <option value="1.7">C-</option>
          <option value="1.3">D+</option>
          <option value="1">D</option>
          <option value="0">E</option>
        </select>
        <button type="button" class="deleteCourseButton" title="Delete Course">
          <i class="fas fa-trash-alt"></i>
        </button>
      `;
      const deleteBtn = course.querySelector('.deleteCourseButton');
      deleteBtn.addEventListener('click', () => {
        course.remove();
        saveCourses();
      });
      return course;
    }

    function addCourseEventListeners() {
      document.querySelectorAll('.course input, .course select').forEach(element => {
        element.addEventListener('change', saveCourses);
      });

      // Add autocomplete functionality for course names
      document.querySelectorAll('.course input[list="courseList"]').forEach(input => {
        input.addEventListener('input', function() {
          const courseList = document.getElementById('courseList');
          const options = courseList.options;
          const creditsInput = this.closest('.course').querySelector('input[type="number"]');
          
          for (let i = 0; i < options.length; i++) {
            if (options[i].value === this.value) {
              creditsInput.value = options[i].dataset.credits;
              break;
            }
          }
        });
      });
    }

    document.getElementById('addCourseButton').addEventListener('click', () => {
      const newCourse = createCourseElement();
      coursesContainer.appendChild(newCourse);
      addCourseEventListeners();
      saveCourses();
      document.getElementById('calculateButton').disabled = false;
    });

    // --------- GPA Calculation ---------
    document.getElementById('gpaForm').addEventListener('submit', (e) => {
      e.preventDefault();
      const courses = document.getElementsByClassName('course');
      let totalCredits = 0;
      let totalPoints = 0;
      const courseData = [];

      Array.from(courses).forEach(course => {
        const inputs = course.querySelectorAll('input, select');
        const courseName = inputs[0].value;
        const credits = parseFloat(inputs[1].value);
        const gradeValue = parseFloat(inputs[2].value);
        const gradeText = inputs[2].options[inputs[2].selectedIndex].text;
        
        if (!isNaN(credits) && !isNaN(gradeValue)) {
          totalCredits += credits;
          totalPoints += credits * gradeValue;
          courseData.push({
            Course: courseName,
            Credits: credits,
            Grade: gradeText
          });
        }
      });

      const gpa = totalCredits > 0 ? (totalPoints / totalCredits) : 0;
      document.getElementById('gpaValue').textContent = gpa.toFixed(2);
      document.getElementById('result').style.display = 'block';
      
      const gpaClass = document.getElementById('gpaClass');
      if (gpa >= 3.7) gpaClass.textContent = 'First Class Honors';
      else if (gpa >= 3.3) gpaClass.textContent = 'Second Class Upper Division';
      else if (gpa >= 3.0) gpaClass.textContent = 'Second Class Lower Division';
      else gpaClass.textContent = 'General Pass';
      
      // Trigger confetti if GPA is greater than 3.0
      if (gpa > 3.0) {
        confetti({
          particleCount: 100,
          spread: 70,
          origin: { y: 0.6 }
        });
      }

      // Set a motivational message
      const highGpaMessages = [
        "Great job! Your hard work is paying off!",
        "Amazing performance! Keep shining!",
        "Fantastic work! Your dedication shows!",
        "Excellent! You're on the right track!"
      ];
      const lowGpaMessages = [
        "Don't worry, every challenge is a stepping stone!",
        "Keep pushing, your best is yet to come!",
        "Stay motivated, you can achieve more!",
        "Every setback is a setup for a comeback!"
      ];
      const msgArray = gpa < 3.0 ? lowGpaMessages : highGpaMessages;
      const randomMsg = msgArray[Math.floor(Math.random() * msgArray.length)];
      document.getElementById('motivationalMessage').textContent = randomMsg;
      
      localStorage.setItem('courseData', JSON.stringify(courseData));
      saveCourses();
    });

    // --------- Generate Excel for Sharing ---------
    function generateExcel() {
      const courseData = JSON.parse(localStorage.getItem('courseData') || '[]');
      const gpa = document.getElementById('gpaValue').textContent;
      const gpaClass = document.getElementById('gpaClass').textContent;

      const wsData = [
        ['Course Name', 'Credits', 'Grade'],
        ...courseData.map(c => [c.Course, c.Credits, c.Grade]),
        [],
        ['Final GPA Achieved', gpa],
        ['Academic Classification', gpaClass]
      ];

      const ws = XLSX.utils.aoa_to_sheet(wsData);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, 'GPA Report');
      return XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
    }

    document.getElementById('shareButton').addEventListener('click', () => {
      const data = generateExcel();
      const blob = new Blob([data], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
      const fileName = `OUSL_GPA_Report_${new Date().toISOString().split('T')[0]}.xlsx`;
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = fileName;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    });

    // --------- Load Existing Data Feature ---------
    document.getElementById('uploadExcelButton').addEventListener('click', () => {
      document.getElementById('uploadExcelInput').click();
    });

    document.getElementById('uploadExcelInput').addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(e) {
        const data = e.target.result;
        const workbook = XLSX.read(data, { type: 'binary' });
        const sheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[sheetName];
        const sheetJson = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
        const headers = sheetJson[0];
        if (!headers || headers[0] !== 'Course Name' || headers[1] !== 'Credits' || headers[2] !== 'Grade') {
          alert('Invalid Excel file format.');
          return;
        }
        coursesContainer.innerHTML = '';
        for (let i = 1; i < sheetJson.length; i++) {
          const row = sheetJson[i];
          if (!row || row.length < 3 || !row[0]) break;
          const courseName = row[0];
          const credits = parseFloat(row[1]);
          const gradeLetter = row[2];
          const course = createCourseElement();
          const inputs = course.querySelectorAll('input, select');
          inputs[0].value = courseName;
          inputs[1].value = credits;
          const select = inputs[2];
          for (let j = 0; j < select.options.length; j++) {
            if (select.options[j].text === gradeLetter) {
              select.selectedIndex = j;
              break;
            }
          }
          coursesContainer.appendChild(course);
        }
        addCourseEventListeners();
        saveCourses();
      };
      reader.readAsBinaryString(file);
    });
    
    // --------- Marksheet Upload Feature ---------
    // Courses to skip (as per requirement)
    const SKIP_COURSES = ['CYE3200', 'CSE3214', 'FDE3021', 'FNE3000', 'LTE3406'];

    // Upload functionality
    const dropArea = document.getElementById('dropArea');
    const fileInput = document.getElementById('fileInput');
    const parseResults = document.getElementById('parseResults');

    dropArea.addEventListener('click', () => {
      fileInput.click();
    });

    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
      dropArea.addEventListener(eventName, preventDefaults, false);
    });

    function preventDefaults(e) {
      e.preventDefault();
      e.stopPropagation();
    }

    ['dragenter', 'dragover'].forEach(eventName => {
      dropArea.addEventListener(eventName, highlight, false);
    });

    ['dragleave', 'drop'].forEach(eventName => {
      dropArea.addEventListener(eventName, unhighlight, false);
    });

    function highlight() {
      dropArea.style.backgroundColor = 'rgba(67, 97, 238, 0.2)';
    }

    function unhighlight() {
      dropArea.style.backgroundColor = '';
    }

    dropArea.addEventListener('drop', handleDrop, false);

    function handleDrop(e) {
      const dt = e.dataTransfer;
      const files = dt.files;
      if (files.length) {
        fileInput.files = files;
        handleFiles(files);
      }
    }

    fileInput.addEventListener('change', function() {
      handleFiles(this.files);
    });

    function handleFiles(files) {
      const file = files[0];
      if (!file) return;
      
      const reader = new FileReader();
      
      reader.onload = function(e) {
        try {
          const data = new Uint8Array(e.target.result);
          const workbook = XLSX.read(data, {type: 'array'});
          const sheetName = workbook.SheetNames[0];
          const worksheet = workbook.Sheets[sheetName];
          
          // Convert to JSON
          const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});
          
          // Process the marksheet data
          const courses = processMarksheet(jsonData);
          displayParsedCourses(courses);
        } catch (error) {
          parseResults.innerHTML = `<p style="color: red;">${translations[currentLang].errorProcessing}: ${error.message}</p>`;
        }
      };
      
      reader.readAsArrayBuffer(file);
    }

    function processMarksheet(data) {
      const courses = [];
      
      // Find the row with headers
      let headerRowIndex = -1;
      for (let i = 0; i < data.length; i++) {
        if (data[i].some(cell => typeof cell === 'string' && cell.includes('Course Code'))) {
          headerRowIndex = i;
          break;
        }
      }
      
      if (headerRowIndex === -1) {
        throw new Error('Could not find header row in the marksheet');
      }
      
      // Map headers to indexes
      const headers = data[headerRowIndex];
      const codeIndex = headers.findIndex(h => h.includes('Course Code'));
      const nameIndex = headers.findIndex(h => h.includes('Course Name'));
      const statusIndex = headers.findIndex(h => h.includes('Progress Status'));
      const gradeIndex = headers.findIndex(h => h.includes('Grade'));
      
      if (codeIndex === -1 || nameIndex === -1 || statusIndex === -1 || gradeIndex === -1) {
        throw new Error('Required columns not found in the marksheet');
      }
      
      // Process each row after the header
      for (let i = headerRowIndex + 1; i < data.length; i++) {
        const row = data[i];
        if (!row[codeIndex]) continue;
        
        const courseCode = String(row[codeIndex]).trim();
        const courseName = row[nameIndex] ? String(row[nameIndex]).trim() : '';
        const progressStatus = row[statusIndex] ? String(row[statusIndex]).trim() : '';
        const grade = row[gradeIndex] ? String(row[gradeIndex]).trim() : '';
        
        // Skip courses that should be disregarded
        if (SKIP_COURSES.includes(courseCode)) continue;
        
        // Skip non-passing grades (only include "Pass" status)
        if (progressStatus !== 'Pass') continue;
        
        // Get credits from course code (5th character)
        const credits = courseCode.length >= 5 ? parseInt(courseCode[4]) : 0;
        
        if (credits > 0 && grade) {
          courses.push({
            code: courseCode,
            name: courseName,
            credits: credits,
            grade: grade
          });
        }
      }
      
      return courses;
    }

    function displayParsedCourses(courses) {
      if (courses.length === 0) {
        parseResults.innerHTML = `<p>${translations[currentLang].coursesFound} 0</p>`;
        return;
      }
      
      let html = `
        <p><strong>${translations[currentLang].coursesFound}</strong> ${courses.length}</p>
        <div class="courses-list">
      `;
      
      courses.forEach(course => {
        html += `
          <div class="parsed-course">
            <strong>${course.code}</strong>: ${course.name} 
            (${translations[currentLang].credits}: ${course.credits}, 
            ${translations[currentLang].grade}: ${course.grade})
          </div>
        `;
      });
      
      html += `
        </div>
        <button id="addCoursesButton" class="process-button">
          <i class="fas fa-calculator"></i> ${translations[currentLang].addToCalculator}
        </button>
      `;
      
      parseResults.innerHTML = html;
      
      document.getElementById('addCoursesButton').addEventListener('click', () => {
        addCoursesToCalculator(courses);
      });
    }

    function addCoursesToCalculator(courses) {
      // Clear existing courses
      coursesContainer.innerHTML = '';
      
      // Add new courses from marksheet
      courses.forEach(course => {
        const newCourse = createCourseElement();
        const inputs = newCourse.querySelectorAll('input, select');
        
        // Set course code/name
        inputs[0].value = course.code;
        
        // Set credits
        inputs[1].value = course.credits;
        
        // Set grade
        const gradeSelect = inputs[2];
        for (let i = 0; i < gradeSelect.options.length; i++) {
          if (gradeSelect.options[i].text === course.grade) {
            gradeSelect.selectedIndex = i;
            break;
          }
        }
        
        coursesContainer.appendChild(newCourse);
      });
      
      // Add event listeners and enable calculate button
      addCourseEventListeners();
      saveCourses();
      document.getElementById('calculateButton').disabled = courses.length === 0;
      
      // Show success message
      parseResults.innerHTML = `<p style="color: green;">${courses.length} ${translations[currentLang].coursesAdded}</p>`;
    }
  </script>
  <a href="https://abishekrkumar.github.io/OUSL-FE-Target-Calc/" class="fab" title="FE Target Calculator">
    <i class="fas fa-bullseye"></i>
  </a>
</body>
</html>
